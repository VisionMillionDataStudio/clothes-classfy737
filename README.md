# æœè£…åˆ†ç±»æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€äº’è”ç½‘å’Œç”µå­å•†åŠ¡çš„è¿…çŒ›å‘å±•ï¼Œæœè£…è¡Œä¸šæ­£ç»å†ç€å‰æ‰€æœªæœ‰çš„å˜é©ã€‚æ¶ˆè´¹è€…çš„è´­ç‰©æ–¹å¼é€æ¸ä»ä¼ ç»Ÿçš„çº¿ä¸‹è´­ç‰©è½¬å‘çº¿ä¸Šè´­ç‰©ï¼Œè¿™ä¸€è½¬å˜ä¸ä»…æ”¹å˜äº†æ¶ˆè´¹è€…çš„è´­ä¹°ä¹ æƒ¯ï¼Œä¹Ÿå¯¹æœè£…è¡Œä¸šçš„ä¾›åº”é“¾ã€åº“å­˜ç®¡ç†å’Œå¸‚åœºè¥é”€ç­–ç•¥æå‡ºäº†æ–°çš„æŒ‘æˆ˜ã€‚åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹ï¼Œå¦‚ä½•é«˜æ•ˆã€å‡†ç¡®åœ°å¯¹æœè£…è¿›è¡Œåˆ†ç±»å’Œæ£€æµ‹ï¼Œæˆä¸ºäº†æå‡åœ¨çº¿è´­ç‰©ä½“éªŒã€ä¼˜åŒ–åº“å­˜ç®¡ç†ä»¥åŠå¢å¼ºå¸‚åœºç«äº‰åŠ›çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚åŸºäºæ­¤ï¼Œå¼€å‘ä¸€ä¸ªé«˜æ•ˆçš„æœè£…åˆ†ç±»æ£€æµ‹ç³»ç»Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­çš„é«˜æ•ˆæ€§å’Œå‡†ç¡®æ€§è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ï¼Œé€‚ç”¨äºå®æ—¶ç›®æ ‡æ£€æµ‹çš„åœºæ™¯ã€‚ç„¶è€Œï¼Œå°½ç®¡YOLOv8åœ¨è®¸å¤šé¢†åŸŸè¡¨ç°å‡ºè‰²ï¼Œä½†åœ¨æœè£…åˆ†ç±»æ£€æµ‹æ–¹é¢ä»å­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼Œä¾‹å¦‚å¤šæ ·åŒ–çš„æœè£…æ¬¾å¼ã€å¤æ‚çš„èƒŒæ™¯å’Œä¸åŒçš„æ‹æ‘„è§’åº¦ç­‰ã€‚å› æ­¤ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æœè£…åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶å…·æœ‰é‡è¦çš„ç°å®æ„ä¹‰ã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«1800å¼ å›¾åƒï¼Œæ¶µç›–äº†8ä¸ªä¸»è¦çš„æœè£…ç±»åˆ«ï¼ŒåŒ…æ‹¬Tæ¤ã€è¿è¡£è£™ã€å¤¹å…‹ã€è£¤å­ã€è¡¬è¡«ã€çŸ­è£¤ã€è£™å­å’Œæ¯›è¡£ã€‚è¿™äº›ç±»åˆ«çš„é€‰æ‹©ä¸ä»…åæ˜ äº†å½“å‰å¸‚åœºä¸Šå¸¸è§çš„æœè£…ç±»å‹ï¼Œä¹Ÿä¸ºæ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•æä¾›äº†ä¸°å¯Œçš„æ ·æœ¬æ•°æ®ã€‚é€šè¿‡å¯¹è¿™äº›å›¾åƒè¿›è¡Œæ ‡æ³¨å’Œåˆ†ç±»ï¼Œå¯ä»¥æœ‰æ•ˆæå‡æ¨¡å‹å¯¹ä¸åŒæœè£…ç±»å‹çš„è¯†åˆ«èƒ½åŠ›ï¼Œè¿›è€Œæé«˜åˆ†ç±»æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚

æ­¤å¤–ï¼Œæœè£…åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„å¼€å‘ä¸ä»…å¯ä»¥ä¸ºæ¶ˆè´¹è€…æä¾›æ›´ä¸ºç²¾å‡†çš„æ¨èæœåŠ¡ï¼Œè¿˜å¯ä»¥å¸®åŠ©å•†å®¶æ›´å¥½åœ°ç®¡ç†åº“å­˜å’Œä¼˜åŒ–ä¾›åº”é“¾ã€‚ä¾‹å¦‚ï¼ŒåŸºäºå‡†ç¡®çš„æœè£…åˆ†ç±»ï¼Œå•†å®¶å¯ä»¥å®æ—¶ç›‘æ§å„ç±»æœè£…çš„é”€å”®æƒ…å†µï¼ŒåŠæ—¶è°ƒæ•´ç”Ÿäº§å’Œé‡‡è´­ç­–ç•¥ï¼Œä»è€Œé™ä½åº“å­˜æˆæœ¬ï¼Œæé«˜èµ„é‡‘å‘¨è½¬ç‡ã€‚åŒæ—¶ï¼Œæ¶ˆè´¹è€…åœ¨æµè§ˆå•†å“æ—¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿæ ¹æ®å…¶å†å²è´­ä¹°è®°å½•å’Œåå¥½ï¼Œæ™ºèƒ½æ¨èç›¸å…³æœè£…ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æœè£…åˆ†ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å…·æœ‰é‡è¦çš„å­¦æœ¯ä»·å€¼ï¼Œä¹Ÿå…·å¤‡æ˜¾è‘—çš„åº”ç”¨å‰æ™¯ã€‚é€šè¿‡æå‡æœè£…åˆ†ç±»çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ¨åŠ¨æœè£…è¡Œä¸šçš„æ•°å­—åŒ–è½¬å‹ï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡çš„å‘å±•ã€‚å› æ­¤ï¼Œæœ¬ç ”ç©¶çš„å¼€å±•å°†ä¸ºæœè£…è¡Œä¸šçš„æ™ºèƒ½åŒ–ã€è‡ªåŠ¨åŒ–æä¾›æœ‰åŠ›çš„æŠ€æœ¯æ”¯æŒï¼Œå…·æœ‰é‡è¦çš„ç†è®ºæ„ä¹‰å’Œå®è·µä»·å€¼ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1tjsfeeEnK/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 8
names: ['Tshirt', 'dress', 'jacket', 'pants', 'shirt', 'short', 'skirt', 'sweater']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œå°¤å…¶æ˜¯åœ¨æœè£…åˆ†ç±»å’Œæ£€æµ‹çš„ä»»åŠ¡ä¸­ï¼Œæ•°æ®é›†çš„è´¨é‡å’Œå¤šæ ·æ€§ç›´æ¥å½±å“åˆ°æ¨¡å‹çš„æ€§èƒ½å’Œæ³›åŒ–èƒ½åŠ›ã€‚æœ¬ç ”ç©¶æ‰€é‡‡ç”¨çš„æ•°æ®é›†åä¸ºâ€œclothes classfyâ€ï¼Œè¯¥æ•°æ®é›†ä¸“é—¨è®¾è®¡ç”¨äºè®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡å‹ï¼Œä»¥å®ç°é«˜æ•ˆçš„æœè£…åˆ†ç±»æ£€æµ‹ã€‚è¯¥æ•°æ®é›†åŒ…å«8ä¸ªä¸åŒçš„æœè£…ç±»åˆ«ï¼Œåˆ†åˆ«ä¸ºTshirtã€dressã€jacketã€pantsã€shirtã€shortã€skirtå’Œsweaterã€‚è¿™äº›ç±»åˆ«æ¶µç›–äº†æ—¥å¸¸ç”Ÿæ´»ä¸­å¸¸è§çš„æœè£…ç±»å‹ï¼Œèƒ½å¤Ÿä¸ºæ¨¡å‹æä¾›ä¸°å¯Œçš„æ ·æœ¬ï¼Œä»¥ä¾¿æ›´å¥½åœ°å­¦ä¹ å’Œè¯†åˆ«å„ç§æœè£…çš„ç‰¹å¾ã€‚

â€œclothes classfyâ€æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹å……åˆ†è€ƒè™‘äº†å¤šæ ·æ€§å’Œä»£è¡¨æ€§ï¼Œç¡®ä¿æ¯ä¸ªç±»åˆ«éƒ½åŒ…å«äº†ä¸åŒé£æ ¼ã€é¢œè‰²å’Œæè´¨çš„æœè£…æ ·æœ¬ã€‚è¿™ç§å¤šæ ·æ€§ä¸ä»…å¢å¼ºäº†æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ï¼Œè¿˜æé«˜äº†å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„é€‚åº”æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨Tshirtç±»åˆ«ä¸­ï¼Œæ•°æ®é›†åŒ…å«äº†çŸ­è¢–ã€é•¿è¢–ã€å°èŠ±å’Œçº¯è‰²ç­‰å¤šç§æ¬¾å¼ï¼Œèƒ½å¤Ÿå¸®åŠ©æ¨¡å‹è¯†åˆ«å‡ºä¸åŒè®¾è®¡å’Œé£æ ¼çš„Tæ¤ã€‚è€Œåœ¨dressç±»åˆ«ä¸­ï¼Œæ•°æ®é›†åˆ™åŒ…æ‹¬äº†è¿è¡£è£™ã€æ™šç¤¼æœå’Œä¼‘é—²è£™ç­‰å¤šç§ç±»å‹ï¼Œè¿›ä¸€æ­¥ä¸°å¯Œäº†æ¨¡å‹çš„è®­ç»ƒæ•°æ®ã€‚

ä¸ºäº†ç¡®ä¿æ•°æ®é›†çš„é«˜è´¨é‡ï¼Œæ‰€æœ‰æ ·æœ¬å‡ç»è¿‡ä¸¥æ ¼çš„æ ‡æ³¨å’Œå®¡æ ¸ã€‚æ¯ä¸ªå›¾åƒéƒ½é…æœ‰å‡†ç¡®çš„æ ‡ç­¾ï¼Œç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ­£ç¡®å­¦ä¹ åˆ°æ¯ä¸ªç±»åˆ«çš„ç‰¹å¾ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†è¿˜è€ƒè™‘åˆ°äº†å›¾åƒçš„æ‹æ‘„è§’åº¦ã€å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯ç¯å¢ƒç­‰å› ç´ ï¼Œä»¥æ¨¡æ‹ŸçœŸå®ä¸–ç•Œä¸­çš„å¤æ‚åœºæ™¯ã€‚è¿™ç§å¤šæ ·åŒ–çš„æ ·æœ¬é€‰æ‹©å’Œç²¾ç¡®çš„æ ‡æ³¨æ–¹å¼ï¼Œä¸ºYOLOv8æ¨¡å‹çš„è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒä¸‹è¿›è¡Œæœ‰æ•ˆçš„æœè£…åˆ†ç±»å’Œæ£€æµ‹ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒYOLOv8æ¨¡å‹å°†åˆ©ç”¨â€œclothes classfyâ€æ•°æ®é›†ä¸­çš„å›¾åƒè¿›è¡Œç‰¹å¾æå–å’Œæ¨¡å¼è¯†åˆ«ã€‚é€šè¿‡æ·±åº¦å­¦ä¹ ç®—æ³•ï¼Œæ¨¡å‹èƒ½å¤Ÿé€æ­¥å­¦ä¹ åˆ°æ¯ä¸ªç±»åˆ«çš„ç‹¬ç‰¹ç‰¹å¾ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„åˆ†ç±»å’Œæ£€æµ‹ã€‚æ•°æ®é›†çš„è®¾è®¡ç†å¿µä¸ä»…å…³æ³¨æ•°é‡ï¼Œæ›´å¼ºè°ƒè´¨é‡ï¼Œç¡®ä¿æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬éƒ½èƒ½ä¸ºæ¨¡å‹çš„å­¦ä¹ æä¾›æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚è¿™ç§æ–¹æ³•å°†æœ‰åŠ©äºæé«˜æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚

æ€»ä¹‹ï¼Œâ€œclothes classfyâ€æ•°æ®é›†ä¸ºæœ¬ç ”ç©¶æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„åŸºç¡€ï¼ŒåŠ©åŠ›äºæ”¹è¿›YOLOv8åœ¨æœè£…åˆ†ç±»æ£€æµ‹ä¸­çš„è¡¨ç°ã€‚é€šè¿‡å¯¹å¤šæ ·åŒ–æ ·æœ¬çš„ç²¾å¿ƒè®¾è®¡å’Œé«˜è´¨é‡æ ‡æ³¨ï¼Œè¯¥æ•°æ®é›†ä¸ä»…ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„èµ„æºï¼Œä¹Ÿä¸ºæœªæ¥çš„ç ”ç©¶å’Œåº”ç”¨å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚éšç€è®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæœè£…åˆ†ç±»æ£€æµ‹çš„å‡†ç¡®æ€§å’Œæ•ˆç‡å°†å¾—åˆ°è¿›ä¸€æ­¥æå‡ï¼Œä¸ºæ—¶å°šè¡Œä¸šçš„æ™ºèƒ½åŒ–å‘å±•è´¡çŒ®åŠ›é‡ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•è‡ªå…¶é¦–æ¬¡æå‡ºä»¥æ¥ï¼Œä¾¿åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸå¼•é¢†äº†æ½®æµã€‚YOLOv8ä½œä¸ºè¿™ä¸€ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ‰¿è½½äº†å‰å‡ ä»£ç®—æ³•çš„åˆ›æ–°ä¸å‘å±•ï¼Œå±•ç°å‡ºæ›´ä¸ºå“è¶Šçš„æ€§èƒ½å’Œçµæ´»æ€§ã€‚å…¶æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯å°†ç›®æ ‡æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºå›å½’é—®é¢˜ï¼Œé€šè¿‡ä¸€ä¸ªå•ä¸€çš„ç¥ç»ç½‘ç»œæ¨¡å‹æ¥åŒæ—¶é¢„æµ‹ç›®æ ‡çš„ä½ç½®å’Œç±»åˆ«ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºå…¶é«˜æ•ˆæ€§ï¼Œèƒ½å¤Ÿåœ¨å®æ—¶åœºæ™¯ä¸­å¿«é€Ÿå¤„ç†å›¾åƒï¼Œæ»¡è¶³äº†ç°ä»£è®¡ç®—æœºè§†è§‰åº”ç”¨å¯¹é€Ÿåº¦å’Œç²¾åº¦çš„åŒé‡éœ€æ±‚ã€‚

YOLOv8çš„ç½‘ç»œç»“æ„ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šä¸»å¹²ç½‘ç»œï¼ˆbackboneï¼‰ã€ç‰¹å¾å¢å¼ºç½‘ç»œï¼ˆneckï¼‰å’Œæ£€æµ‹å¤´ï¼ˆheadï¼‰ã€‚åœ¨ä¸»å¹²ç½‘ç»œä¸­ï¼ŒYOLOv8ç»§ç»­é‡‡ç”¨äº†CSPï¼ˆCross Stage Partialï¼‰ç»“æ„çš„æ€æƒ³ï¼Œæ—¨åœ¨é€šè¿‡åˆ†å‰²ç‰¹å¾å›¾æ¥å¢å¼ºç‰¹å¾æå–çš„èƒ½åŠ›ã€‚CSPç»“æ„é€šè¿‡å°†ç‰¹å¾å›¾åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«è¿›è¡Œå¤„ç†ï¼Œæœ€åå†è¿›è¡Œåˆå¹¶ï¼Œè¿™ç§æ–¹å¼ä¸ä»…æé«˜äº†ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ï¼Œè¿˜æœ‰æ•ˆåœ°å‡è½»äº†æ¨¡å‹çš„è®¡ç®—è´Ÿæ‹…ã€‚YOLOv8åœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥å¼•å…¥äº†C2fæ¨¡å—ï¼Œè¿™ä¸€æ¨¡å—ç»“åˆäº†YOLOv7ä¸­çš„ELANï¼ˆEfficient Layer Aggregation Networkï¼‰æ¨¡å—çš„è®¾è®¡ï¼Œå¢å¼ºäº†æ®‹å·®è¿æ¥çš„æ•°é‡ï¼Œä½¿å¾—ç½‘ç»œåœ¨ä¿æŒè½»é‡åŒ–çš„åŒæ—¶ï¼Œèƒ½å¤Ÿè·å¾—æ›´ä¸°å¯Œçš„æ¢¯åº¦ä¿¡æ¯ï¼Œä»è€Œæå‡äº†æ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚

ç‰¹å¾å¢å¼ºç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†PAN-FPNï¼ˆPath Aggregation Network - Feature Pyramid Networkï¼‰çš„ç»“æ„ã€‚è¿™ä¸€ç»“æ„çš„è®¾è®¡æ—¨åœ¨æ›´å¥½åœ°èåˆå¤šå°ºåº¦ç‰¹å¾ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆå¤„ç†ä¸åŒå¤§å°çš„ç›®æ ‡ã€‚PAN-FPNé€šè¿‡è‡ªä¸‹è€Œä¸Šçš„è·¯å¾„èšåˆç‰¹å¾ï¼Œç»“åˆè‡ªä¸Šè€Œä¸‹çš„ç‰¹å¾ä¼ æ’­ï¼Œå½¢æˆäº†ä¸€ä¸ªæ›´ä¸ºå…¨é¢çš„ç‰¹å¾è¡¨ç¤ºã€‚ä¸ä»¥å¾€çš„YOLOç‰ˆæœ¬ç›¸æ¯”ï¼ŒYOLOv8åœ¨ç‰¹å¾å¢å¼ºæ–¹é¢çš„åˆ›æ–°ä½¿å¾—æ¨¡å‹åœ¨å¤æ‚åœºæ™¯ä¸‹çš„è¡¨ç°æ›´åŠ ä¼˜å¼‚ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹ç›®æ ‡çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚

åœ¨æ£€æµ‹å¤´éƒ¨åˆ†ï¼ŒYOLOv8å¼•å…¥äº†å…¨æ–°çš„è§£è€¦åˆå¤´ç»“æ„ã€‚è¿™ä¸€ç»“æ„å°†ç›®æ ‡çš„åˆ†ç±»å’Œå›å½’ä»»åŠ¡åˆ†ç¦»ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„åˆ†æ”¯ï¼Œå…è®¸æ¨¡å‹åœ¨å¤„ç†æ¯ä¸ªä»»åŠ¡æ—¶æ›´åŠ ä¸“æ³¨ã€‚è¿™ç§è§£è€¦åˆçš„è®¾è®¡è§£å†³äº†ä»¥å¾€æ¨¡å‹åœ¨å¤æ‚åœºæ™¯ä¸‹å®šä½ä¸å‡†å’Œåˆ†ç±»é”™è¯¯çš„é—®é¢˜ï¼Œæ˜¾è‘—æé«˜äº†æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚åŒæ—¶ï¼ŒYOLOv8é‡‡ç”¨äº†Anchor-freeçš„ç›®æ ‡æ£€æµ‹æ–¹æ³•ï¼Œæ‘†è„±äº†ä¼ ç»Ÿç›®æ ‡æ£€æµ‹ä¸­éœ€è¦é¢„å…ˆå®šä¹‰é”šç‚¹æ¡†çš„é™åˆ¶ã€‚é€šè¿‡ç›´æ¥å›å½’ç›®æ ‡çš„ä½ç½®å’Œå¤§å°ï¼ŒYOLOv8èƒ½å¤Ÿæ›´å¿«é€Ÿåœ°èšç„¦äºç›®æ ‡ä½ç½®çš„é‚»è¿‘ç‚¹ï¼Œä½¿å¾—é¢„æµ‹æ¡†æ›´æ¥è¿‘äºå®é™…çš„è¾¹ç•Œæ¡†åŒºåŸŸã€‚è¿™ä¸€åˆ›æ–°ä¸ä»…ç®€åŒ–äº†æ¨¡å‹çš„è®¾è®¡ï¼Œè¿˜æå‡äº†æ£€æµ‹çš„çµæ´»æ€§å’Œå‡†ç¡®æ€§ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒYOLOv8é‡‡ç”¨äº†ä¸€ç³»åˆ—å…ˆè¿›çš„æ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œå€Ÿé‰´äº†YOLOXä¸­çš„åŠ¨æ€æ ·æœ¬åˆ†é…ç­–ç•¥ã€‚é€šè¿‡åœ¨è®­ç»ƒçš„æœ€å10ä¸ªepochä¸­å…³é—­é©¬èµ›å…‹å¢å¼ºï¼ŒYOLOv8èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”çœŸå®åœºæ™¯ä¸­çš„ç›®æ ‡åˆ†å¸ƒã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨æŸå¤±è®¡ç®—æ–¹é¢ä¹Ÿè¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½¿ç”¨äº†BCELossä½œä¸ºåˆ†ç±»æŸå¤±ï¼ŒDFLLosså’ŒCIoULossä½œä¸ºå›å½’æŸå¤±ã€‚è¿™ç§å¤šæ ·åŒ–çš„æŸå¤±å‡½æ•°è®¾è®¡ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å¹³è¡¡åˆ†ç±»å’Œå›å½’ä»»åŠ¡çš„æƒé‡ï¼Œä»è€Œæå‡æ•´ä½“æ€§èƒ½ã€‚

YOLOv8çš„å‘å¸ƒæ ‡å¿—ç€ç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„åˆä¸€æ¬¡é£è·ƒã€‚ä¸ä¹‹å‰çš„YOLOç³»åˆ—ç›¸æ¯”ï¼ŒYOLOv8åœ¨è®­ç»ƒæ—¶é—´å’Œæ£€æµ‹ç²¾åº¦ä¸Šéƒ½å¾—åˆ°äº†æ˜¾è‘—æå‡ï¼Œå…¶æ¨¡å‹æƒé‡æ–‡ä»¶çš„è½»é‡åŒ–è®¾è®¡ä½¿å¾—å®ƒèƒ½å¤Ÿåœ¨å„ç§åµŒå…¥å¼è®¾å¤‡ä¸Šè¿›è¡Œéƒ¨ç½²ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—YOLOv8åœ¨å®æ—¶æ£€æµ‹çš„åº”ç”¨åœºæ™¯ä¸­è¡¨ç°å°¤ä¸ºå‡ºè‰²ï¼Œèƒ½å¤Ÿæ»¡è¶³ç°ä»£æ™ºèƒ½è®¾å¤‡å¯¹å¿«é€Ÿå“åº”å’Œé«˜æ•ˆå¤„ç†çš„éœ€æ±‚ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8é€šè¿‡ä¸€ç³»åˆ—åˆ›æ–°çš„è®¾è®¡å’Œä¼˜åŒ–ï¼Œå±•ç°äº†å…¶åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„å¼ºå¤§èƒ½åŠ›ã€‚æ— è®ºæ˜¯åœ¨ç‰¹å¾æå–ã€ç‰¹å¾èåˆï¼Œè¿˜æ˜¯åœ¨ä»»åŠ¡è§£è€¦å’ŒæŸå¤±è®¡ç®—æ–¹é¢ï¼ŒYOLOv8éƒ½å®ç°äº†è´¨çš„é£è·ƒã€‚éšç€YOLOv8çš„å¹¿æ³›åº”ç”¨ï¼Œæœªæ¥çš„ç›®æ ‡æ£€æµ‹æŠ€æœ¯å°†è¿æ¥æ›´åŠ å¹¿é˜”çš„å‘å±•å‰æ™¯ã€‚æ— è®ºæ˜¯åœ¨å†œä¸šã€å·¥ä¸šï¼Œè¿˜æ˜¯åœ¨æ™ºèƒ½ç›‘æ§ç­‰é¢†åŸŸï¼ŒYOLOv8éƒ½å°†ä¸ºè‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–çš„è¿›ç¨‹æä¾›å¼ºæœ‰åŠ›çš„æ”¯æŒï¼Œæ¨åŠ¨ç›¸å…³æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ä¸å‘å±•ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\models\fastsam\__init__.py

ä¸‹é¢æ˜¯å¯¹ç»™å®šä»£ç çš„é€è¡Œåˆ†æå’Œæ³¨é‡Šï¼Œä¿ç•™äº†æ ¸å¿ƒéƒ¨åˆ†å¹¶è¿›è¡Œäº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ FastSAM æ¨¡å‹ç±»
from .model import FastSAM

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ FastSAMPredictor ç±»ï¼Œç”¨äºè¿›è¡Œé¢„æµ‹
from .predict import FastSAMPredictor

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ FastSAMPrompt ç±»ï¼Œç”¨äºå¤„ç†æç¤ºä¿¡æ¯
from .prompt import FastSAMPrompt

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ FastSAMValidator ç±»ï¼Œç”¨äºéªŒè¯æ¨¡å‹çš„æ€§èƒ½
from .val import FastSAMValidator

# å®šä¹‰æ¨¡å—çš„å…¬å¼€æ¥å£ï¼ŒåŒ…å«å¯ä»¥è¢«å¤–éƒ¨è®¿é—®çš„ç±»
__all__ = "FastSAMPredictor", "FastSAM", "FastSAMPrompt", "FastSAMValidator"
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æï¼š

1. **æ¨¡å—å¯¼å…¥**ï¼š
   - ä»£ç é€šè¿‡ç›¸å¯¹å¯¼å…¥çš„æ–¹å¼å¼•å…¥äº†å››ä¸ªæ ¸å¿ƒç±»ï¼š`FastSAM`ã€`FastSAMPredictor`ã€`FastSAMPrompt` å’Œ `FastSAMValidator`ã€‚è¿™äº›ç±»åˆ†åˆ«æ‰¿æ‹…ä¸åŒçš„åŠŸèƒ½ï¼Œæ˜¯å®ç°YOLOæ¨¡å‹çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚

2. **`__all__` çš„å®šä¹‰**ï¼š
   - `__all__` æ˜¯ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œç”¨äºå®šä¹‰æ¨¡å—çš„å…¬å…±æ¥å£ã€‚å®ƒåˆ—å‡ºäº†å¯ä»¥è¢«å¤–éƒ¨å¯¼å…¥çš„ç±»åã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨ `from module import *` æ—¶ï¼Œåªä¼šå¯¼å…¥è¿™äº›æŒ‡å®šçš„ç±»ï¼Œä»è€Œé¿å…äº†ä¸å¿…è¦çš„å‘½åå†²çªå’Œéšè—å®ç°ç»†èŠ‚ã€‚

### å„ä¸ªç±»çš„åŠŸèƒ½ï¼ˆå‡è®¾ï¼‰ï¼š

- **FastSAM**ï¼šå¯èƒ½æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å‹ç±»ï¼Œè´Ÿè´£æ¨¡å‹çš„æ„å»ºå’Œè®­ç»ƒã€‚
- **FastSAMPredictor**ï¼šç”¨äºæ‰§è¡Œæ¨¡å‹çš„é¢„æµ‹åŠŸèƒ½ï¼Œå¤„ç†è¾“å…¥æ•°æ®å¹¶è¿”å›é¢„æµ‹ç»“æœã€‚
- **FastSAMPrompt**ï¼šå¯èƒ½ç”¨äºå¤„ç†ç”¨æˆ·è¾“å…¥çš„æç¤ºä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°ä¸æ¨¡å‹äº¤äº’ã€‚
- **FastSAMValidator**ï¼šç”¨äºéªŒè¯æ¨¡å‹çš„æ€§èƒ½ï¼Œå¯èƒ½åŒ…æ‹¬è¯„ä¼°æŒ‡æ ‡çš„è®¡ç®—å’Œç»“æœçš„å¯è§†åŒ–ã€‚

ä»¥ä¸Šæ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†åŠå…¶åŠŸèƒ½çš„è¯¦ç»†æ³¨é‡Šå’Œåˆ†æã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªPythonæ¨¡å—çš„åˆå§‹åŒ–æ–‡ä»¶ï¼Œä½äºUltralytics YOLOé¡¹ç›®çš„`fastsam`å­ç›®å½•ä¸‹ã€‚æ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¼å…¥å’Œæš´éœ²è¯¥æ¨¡å—ä¸­çš„å‡ ä¸ªå…³é”®ç±»ï¼Œä»¥ä¾¿å…¶ä»–æ¨¡å—å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨å®ƒä»¬ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶çš„å¼€å¤´æœ‰ä¸€è¡Œæ³¨é‡Šï¼Œè¡¨æ˜è¯¥é¡¹ç›®æ˜¯Ultralytics YOLOï¼Œå¹¶ä¸”ä½¿ç”¨AGPL-3.0è®¸å¯è¯ã€‚è¿™ä¸ºç”¨æˆ·æä¾›äº†å…³äºé¡¹ç›®ç‰ˆæƒå’Œä½¿ç”¨æ¡æ¬¾çš„ä¿¡æ¯ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶é€šè¿‡ç›¸å¯¹å¯¼å…¥çš„æ–¹å¼å¼•å…¥äº†å››ä¸ªç±»ï¼š`FastSAM`ã€`FastSAMPredictor`ã€`FastSAMPrompt`å’Œ`FastSAMValidator`ã€‚è¿™äº›ç±»åˆ†åˆ«æ¥è‡ªäºåŒä¸€ç›®å½•ä¸‹çš„ä¸åŒæ¨¡å—æ–‡ä»¶ã€‚å…·ä½“æ¥è¯´ï¼š

- `FastSAM`ç±»å¯èƒ½æ˜¯å®ç°FastSAMç®—æ³•çš„æ ¸å¿ƒåŠŸèƒ½ã€‚
- `FastSAMPredictor`ç±»å¯èƒ½è´Ÿè´£å¤„ç†é¢„æµ‹ä»»åŠ¡ï¼Œåˆ©ç”¨FastSAMç®—æ³•è¿›è¡Œæ¨æ–­ã€‚
- `FastSAMPrompt`ç±»å¯èƒ½ä¸ç”¨æˆ·è¾“å…¥æˆ–æç¤ºç›¸å…³ï¼Œæä¾›äº¤äº’åŠŸèƒ½ã€‚
- `FastSAMValidator`ç±»å¯èƒ½ç”¨äºéªŒè¯æ¨¡å‹çš„æ€§èƒ½æˆ–è¾“å‡ºç»“æœã€‚

æœ€åï¼Œ`__all__`å˜é‡å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²å…ƒç»„ï¼Œåˆ—å‡ºäº†è¯¥æ¨¡å—å¸Œæœ›å…¬å¼€çš„æ¥å£å†…å®¹ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½¿ç”¨`from fastsam import *`çš„æ–¹å¼å¯¼å…¥æ—¶ï¼Œåªæœ‰è¿™äº›åˆ—å‡ºçš„ç±»ä¼šè¢«å¯¼å…¥ï¼Œå…¶ä»–æœªåˆ—å‡ºçš„å†…å®¹å°†ä¸ä¼šè¢«å¯¼å…¥ã€‚è¿™æ˜¯ä¸€ç§æ§åˆ¶æ¨¡å—å…¬å…±æ¥å£çš„æ–¹å¼ï¼Œæœ‰åŠ©äºé¿å…å‘½åå†²çªå’Œä¿æŠ¤å†…éƒ¨å®ç°ç»†èŠ‚ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåˆå§‹åŒ–æ–‡ä»¶çš„ä½œç”¨æ˜¯ç»„ç»‡å’Œç®€åŒ–æ¨¡å—çš„ä½¿ç”¨ï¼Œä½¿å¾—å…¶ä»–éƒ¨åˆ†çš„ä»£ç èƒ½å¤Ÿæ–¹ä¾¿åœ°è®¿é—®å’Œä½¿ç”¨FastSAMç›¸å…³çš„åŠŸèƒ½ã€‚

#### 11.2 code\ultralytics\utils\torch_utils.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

def select_device(device="", batch=0, newline=False, verbose=True):
    """
    æ ¹æ®æä¾›çš„å‚æ•°é€‰æ‹©åˆé€‚çš„ PyTorch è®¾å¤‡ã€‚

    å‚æ•°:
        device (str | torch.device, optional): è®¾å¤‡å­—ç¬¦ä¸²æˆ– torch.device å¯¹è±¡ã€‚
            é€‰é¡¹åŒ…æ‹¬ 'None', 'cpu', 'cuda', '0' æˆ– '0,1,2,3'ã€‚é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨çš„ GPUï¼Œæˆ–åœ¨æ²¡æœ‰ GPU æ—¶é€‰æ‹© CPUã€‚
        batch (int, optional): æ¨¡å‹ä½¿ç”¨çš„æ‰¹é‡å¤§å°ã€‚é»˜è®¤ä¸º 0ã€‚
        newline (bool, optional): å¦‚æœä¸º Trueï¼Œåˆ™åœ¨æ—¥å¿—å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ æ¢è¡Œç¬¦ã€‚é»˜è®¤ä¸º Falseã€‚
        verbose (bool, optional): å¦‚æœä¸º Trueï¼Œåˆ™è®°å½•è®¾å¤‡ä¿¡æ¯ã€‚é»˜è®¤ä¸º Trueã€‚

    è¿”å›:
        (torch.device): é€‰æ‹©çš„è®¾å¤‡ã€‚

    å¼‚å¸¸:
        ValueError: å¦‚æœæŒ‡å®šçš„è®¾å¤‡ä¸å¯ç”¨ï¼Œæˆ–è€…åœ¨ä½¿ç”¨å¤šä¸ª GPU æ—¶æ‰¹é‡å¤§å°ä¸æ˜¯è®¾å¤‡æ•°é‡çš„å€æ•°ã€‚
    """
    if isinstance(device, torch.device):
        return device

    device = str(device).lower()
    cpu = device == "cpu"
    if cpu:
        os.environ["CUDA_VISIBLE_DEVICES"] = "-1"  # å¼ºåˆ¶ torch.cuda.is_available() = False
    elif device:  # è¯·æ±‚é CPU è®¾å¤‡
        if device == "cuda":
            device = "0"
        os.environ["CUDA_VISIBLE_DEVICES"] = device  # è®¾ç½®ç¯å¢ƒå˜é‡
        if not (torch.cuda.is_available() and torch.cuda.device_count() >= len(device.replace(",", ""))):
            raise ValueError(f"æ— æ•ˆçš„ CUDA 'device={device}' è¯·æ±‚ã€‚")

    if not cpu and torch.cuda.is_available():  # ä¼˜å…ˆä½¿ç”¨å¯ç”¨çš„ GPU
        devices = device.split(",") if device else "0"  # ä¾‹å¦‚ 0,1,6,7
        n = len(devices)  # è®¾å¤‡æ•°é‡
        if n > 1 and batch > 0 and batch % n != 0:  # æ£€æŸ¥æ‰¹é‡å¤§å°æ˜¯å¦èƒ½è¢«è®¾å¤‡æ•°é‡æ•´é™¤
            raise ValueError(f"'batch={batch}' å¿…é¡»æ˜¯ GPU æ•°é‡ {n} çš„å€æ•°ã€‚")
        arg = "cuda:0"
    else:  # å›é€€åˆ° CPU
        arg = "cpu"

    return torch.device(arg)

def fuse_conv_and_bn(conv, bn):
    """èåˆ Conv2d() å’Œ BatchNorm2d() å±‚ã€‚"""
    fusedconv = nn.Conv2d(
        conv.in_channels,
        conv.out_channels,
        kernel_size=conv.kernel_size,
        stride=conv.stride,
        padding=conv.padding,
        dilation=conv.dilation,
        groups=conv.groups,
        bias=True,
    ).requires_grad_(False).to(conv.weight.device)

    # å‡†å¤‡æ»¤æ³¢å™¨
    w_conv = conv.weight.clone().view(conv.out_channels, -1)
    w_bn = torch.diag(bn.weight.div(torch.sqrt(bn.eps + bn.running_var)))
    fusedconv.weight.copy_(torch.mm(w_bn, w_conv).view(fusedconv.weight.shape))

    # å‡†å¤‡ç©ºé—´åç½®
    b_conv = torch.zeros(conv.weight.size(0), device=conv.weight.device) if conv.bias is None else conv.bias
    b_bn = bn.bias - bn.weight.mul(bn.running_mean).div(torch.sqrt(bn.running_var + bn.eps))
    fusedconv.bias.copy_(torch.mm(w_bn, b_conv.reshape(-1, 1)).reshape(-1) + b_bn)

    return fusedconv

def initialize_weights(model):
    """åˆå§‹åŒ–æ¨¡å‹æƒé‡ä¸ºéšæœºå€¼ã€‚"""
    for m in model.modules():
        if isinstance(m, nn.Conv2d):
            nn.init.kaiming_normal_(m.weight, mode='fan_out', nonlinearity='relu')  # ä½¿ç”¨ Kaiming æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–å·ç§¯å±‚æƒé‡
        elif isinstance(m, nn.BatchNorm2d):
            m.eps = 1e-3  # è®¾ç½® BatchNorm çš„ epsilon
            m.momentum = 0.03  # è®¾ç½® BatchNorm çš„åŠ¨é‡

def time_sync():
    """è¿”å› PyTorch ç²¾ç¡®çš„æ—¶é—´ã€‚"""
    if torch.cuda.is_available():
        torch.cuda.synchronize()  # åŒæ­¥ CUDA è®¾å¤‡
    return time.time()  # è¿”å›å½“å‰æ—¶é—´
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è§£é‡Šï¼š
1. **è®¾å¤‡é€‰æ‹© (`select_device`)**: è¯¥å‡½æ•°ç”¨äºé€‰æ‹©é€‚åˆçš„è®¡ç®—è®¾å¤‡ï¼ˆCPUæˆ–GPUï¼‰ï¼Œå¹¶æ£€æŸ¥è®¾å¤‡çš„å¯ç”¨æ€§ã€‚å®ƒä¼šæ ¹æ®è¾“å…¥çš„è®¾å¤‡å­—ç¬¦ä¸²æˆ–å¯¹è±¡è¿”å›ç›¸åº”çš„ `torch.device` å¯¹è±¡ã€‚

2. **å·ç§¯ä¸æ‰¹å½’ä¸€åŒ–èåˆ (`fuse_conv_and_bn`)**: è¯¥å‡½æ•°å°†å·ç§¯å±‚å’Œæ‰¹å½’ä¸€åŒ–å±‚èåˆä¸ºä¸€ä¸ªå±‚ï¼Œä»¥æé«˜æ¨ç†é€Ÿåº¦å’Œå‡å°‘è®¡ç®—é‡ã€‚èåˆåï¼Œå·ç§¯å±‚çš„æƒé‡å’Œåç½®è¢«é‡æ–°è®¡ç®—å¹¶å­˜å‚¨åœ¨æ–°çš„å·ç§¯å±‚ä¸­ã€‚

3. **æƒé‡åˆå§‹åŒ– (`initialize_weights`)**: è¯¥å‡½æ•°ç”¨äºåˆå§‹åŒ–æ¨¡å‹ä¸­å„å±‚çš„æƒé‡ï¼Œç‰¹åˆ«æ˜¯å·ç§¯å±‚å’Œæ‰¹å½’ä¸€åŒ–å±‚çš„æƒé‡ï¼Œä»¥ç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒå¼€å§‹æ—¶å…·æœ‰è‰¯å¥½çš„åˆå§‹çŠ¶æ€ã€‚

4. **æ—¶é—´åŒæ­¥ (`time_sync`)**: è¯¥å‡½æ•°ç”¨äºè·å–å½“å‰æ—¶é—´ï¼Œå¹¶åœ¨ä½¿ç”¨ GPU æ—¶ç¡®ä¿æ‰€æœ‰ CUDA æ“ä½œå®Œæˆï¼Œä»¥ä¾¿è·å–å‡†ç¡®çš„æ—¶é—´æµ‹é‡ã€‚

è¿™äº›å‡½æ•°æ˜¯æ„å»ºå’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶çš„åŸºç¡€å·¥å…·ï¼Œç¡®ä¿æ¨¡å‹åœ¨ä¸åŒè®¾å¤‡ä¸Šé«˜æ•ˆè¿è¡Œï¼Œå¹¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿æŒè‰¯å¥½çš„æ€§èƒ½ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªä¸Ultralytics YOLOï¼ˆYou Only Look Onceï¼‰ç›¸å…³çš„å·¥å…·æ¨¡å—ï¼Œä¸»è¦ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œæ¨ç†ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨PyTorchæ¡†æ¶æ—¶ã€‚ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªåŠŸèƒ½å‡½æ•°å’Œç±»ï¼Œæ—¨åœ¨æé«˜æ¨¡å‹çš„æ€§èƒ½å’Œè®­ç»ƒæ•ˆç‡ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬æ•°å­¦è®¡ç®—ã€æ“ä½œç³»ç»Ÿäº¤äº’ã€éšæœºæ•°ç”Ÿæˆã€æ—¶é—´å¤„ç†ã€ä¸Šä¸‹æ–‡ç®¡ç†ã€æ·±æ‹·è´ã€è·¯å¾„å¤„ç†ä»¥åŠç±»å‹æç¤ºç­‰ã€‚æ­¤å¤–ï¼Œè¿˜å¯¼å…¥äº†NumPyå’ŒPyTorchçš„ç›¸å…³æ¨¡å—ï¼Œä»¥åŠUltralyticsåº“ä¸­çš„ä¸€äº›å·¥å…·å’Œæ—¥å¿—è®°å½•åŠŸèƒ½ã€‚

æ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªå‡½æ•°å’Œç±»ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦åŠŸèƒ½çš„ç®€è¦è¯´æ˜ï¼š

1. **åˆ†å¸ƒå¼è®­ç»ƒç®¡ç†**ï¼šé€šè¿‡`torch_distributed_zero_first`ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œæ‰€æœ‰è¿›ç¨‹åœ¨æœ¬åœ°ä¸»è¿›ç¨‹å®ŒæˆæŸäº›æ“ä½œä¹‹å‰éƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚

2. **æ™ºèƒ½æ¨ç†æ¨¡å¼**ï¼š`smart_inference_mode`å‡½æ•°æ ¹æ®PyTorchçš„ç‰ˆæœ¬é€‰æ‹©åˆé€‚çš„æ¨ç†æ¨¡å¼ï¼Œç¡®ä¿åœ¨æ¨ç†æ—¶ä¸ä¼šè®¡ç®—æ¢¯åº¦ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚

3. **è®¾å¤‡é€‰æ‹©**ï¼š`select_device`å‡½æ•°æ ¹æ®ç”¨æˆ·è¾“å…¥çš„è®¾å¤‡å­—ç¬¦ä¸²ï¼ˆå¦‚'cpu'æˆ–'cuda'ï¼‰é€‰æ‹©åˆé€‚çš„PyTorchè®¾å¤‡ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œä»¥ç¡®ä¿æ¨¡å‹èƒ½å¤Ÿåœ¨æŒ‡å®šçš„è®¾å¤‡ä¸Šè¿è¡Œã€‚

4. **æ¨¡å‹ä¿¡æ¯**ï¼š`model_info`å‡½æ•°æä¾›æœ‰å…³æ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‚æ•°æ•°é‡ã€æ¢¯åº¦æ•°é‡å’Œå±‚æ•°ç­‰ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°è¾“å‡ºè¯¦ç»†çš„å±‚çº§ä¿¡æ¯ã€‚

5. **æ¨¡å‹å‚æ•°å’Œæ¢¯åº¦è®¡ç®—**ï¼š`get_num_params`å’Œ`get_num_gradients`å‡½æ•°åˆ†åˆ«è®¡ç®—æ¨¡å‹çš„æ€»å‚æ•°æ•°é‡å’Œå…·æœ‰æ¢¯åº¦çš„å‚æ•°æ•°é‡ã€‚

6. **FLOPsè®¡ç®—**ï¼š`get_flops`å’Œ`get_flops_with_torch_profiler`å‡½æ•°ç”¨äºè®¡ç®—æ¨¡å‹çš„æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼ˆFLOPsï¼‰ï¼Œè¿™å¯¹äºè¯„ä¼°æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦éå¸¸é‡è¦ã€‚

7. **æƒé‡åˆå§‹åŒ–**ï¼š`initialize_weights`å‡½æ•°ç”¨äºåˆå§‹åŒ–æ¨¡å‹çš„æƒé‡ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒå¼€å§‹æ—¶è®¾ç½®åˆé€‚çš„åˆå§‹å€¼ã€‚

8. **å›¾åƒç¼©æ”¾å’Œå¡«å……**ï¼š`scale_img`å‡½æ•°æ ¹æ®ç»™å®šçš„æ¯”ä¾‹å’Œç½‘æ ¼å¤§å°å¯¹å›¾åƒè¿›è¡Œç¼©æ”¾å’Œå¡«å……ï¼Œç¡®ä¿è¾“å…¥å›¾åƒç¬¦åˆæ¨¡å‹çš„è¦æ±‚ã€‚

9. **æ¨¡å‹çš„EMAï¼ˆæŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼‰**ï¼š`ModelEMA`ç±»ç”¨äºç»´æŠ¤æ¨¡å‹å‚æ•°çš„ç§»åŠ¨å¹³å‡ï¼Œæœ‰åŠ©äºæé«˜æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚

10. **æ—©åœæœºåˆ¶**ï¼š`EarlyStopping`ç±»ç”¨äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç›‘æ§æ¨¡å‹çš„æ€§èƒ½ï¼Œå¹¶åœ¨è‹¥å¹²ä¸ªepochå†…æ²¡æœ‰æ”¹è¿›æ—¶æå‰åœæ­¢è®­ç»ƒï¼Œä»¥é¿å…è¿‡æ‹Ÿåˆã€‚

11. **ä¼˜åŒ–å™¨å‰¥ç¦»**ï¼š`strip_optimizer`å‡½æ•°ç”¨äºä»è®­ç»ƒå¥½çš„æ¨¡å‹ä¸­å‰¥ç¦»ä¼˜åŒ–å™¨ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨æ¨ç†æ—¶å‡å°æ¨¡å‹æ–‡ä»¶çš„å¤§å°ã€‚

12. **æ€§èƒ½åˆ†æ**ï¼š`profile`å‡½æ•°ç”¨äºåˆ†ææ¨¡å‹çš„é€Ÿåº¦ã€å†…å­˜å’ŒFLOPsï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚

è¿™äº›åŠŸèƒ½ç»“åˆåœ¨ä¸€èµ·ï¼Œä½¿å¾—è¯¥æ¨¡å—æˆä¸ºYOLOæ¨¡å‹è®­ç»ƒå’Œæ¨ç†çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€ä¼˜åŒ–æ€§èƒ½ï¼Œå¹¶æä¾›ä¸°å¯Œçš„æ¨¡å‹ä¿¡æ¯ã€‚

#### 11.3 code\ultralytics\data\build.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import random
import numpy as np
import torch
from torch.utils.data import dataloader, distributed
from .dataset import YOLODataset
from .utils import PIN_MEMORY

class InfiniteDataLoader(dataloader.DataLoader):
    """
    æ— é™å¾ªç¯çš„æ•°æ®åŠ è½½å™¨ï¼Œç»§æ‰¿è‡ª PyTorch çš„ DataLoaderã€‚
    è¯¥åŠ è½½å™¨ä¼šé‡å¤ä½¿ç”¨å·¥ä½œçº¿ç¨‹ã€‚
    """

    def __init__(self, *args, **kwargs):
        """åˆå§‹åŒ–æ— é™æ•°æ®åŠ è½½å™¨ï¼Œè®¾ç½®æ‰¹æ¬¡é‡‡æ ·å™¨ä¸ºé‡å¤é‡‡æ ·å™¨ã€‚"""
        super().__init__(*args, **kwargs)
        object.__setattr__(self, "batch_sampler", _RepeatSampler(self.batch_sampler))
        self.iterator = super().__iter__()

    def __len__(self):
        """è¿”å›æ‰¹æ¬¡é‡‡æ ·å™¨çš„é•¿åº¦ã€‚"""
        return len(self.batch_sampler.sampler)

    def __iter__(self):
        """åˆ›å»ºä¸€ä¸ªæ— é™é‡å¤çš„é‡‡æ ·å™¨ã€‚"""
        for _ in range(len(self)):
            yield next(self.iterator)

    def reset(self):
        """
        é‡ç½®è¿­ä»£å™¨ã€‚

        å½“æˆ‘ä»¬æƒ³åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿®æ”¹æ•°æ®é›†è®¾ç½®æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ã€‚
        """
        self.iterator = self._get_iterator()


class _RepeatSampler:
    """
    æ°¸ä¹…é‡å¤çš„é‡‡æ ·å™¨ã€‚

    å‚æ•°:
        sampler (Dataset.sampler): è¦é‡å¤çš„é‡‡æ ·å™¨ã€‚
    """

    def __init__(self, sampler):
        """åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å…¶æ— é™é‡å¤ç»™å®šçš„é‡‡æ ·å™¨ã€‚"""
        self.sampler = sampler

    def __iter__(self):
        """è¿­ä»£ç»™å®šçš„é‡‡æ ·å™¨å¹¶è¿”å›å…¶å†…å®¹ã€‚"""
        while True:
            yield from iter(self.sampler)


def seed_worker(worker_id):
    """è®¾ç½®æ•°æ®åŠ è½½å™¨å·¥ä½œçº¿ç¨‹çš„éšæœºç§å­ã€‚"""
    worker_seed = torch.initial_seed() % 2**32  # è·å–å½“å‰çº¿ç¨‹çš„éšæœºç§å­
    np.random.seed(worker_seed)  # è®¾ç½® NumPy éšæœºç§å­
    random.seed(worker_seed)  # è®¾ç½® Python éšæœºç§å­


def build_yolo_dataset(cfg, img_path, batch, data, mode="train", rect=False, stride=32):
    """æ„å»º YOLO æ•°æ®é›†ã€‚"""
    return YOLODataset(
        img_path=img_path,  # å›¾åƒè·¯å¾„
        imgsz=cfg.imgsz,  # å›¾åƒå¤§å°
        batch_size=batch,  # æ‰¹æ¬¡å¤§å°
        augment=mode == "train",  # æ˜¯å¦è¿›è¡Œæ•°æ®å¢å¼º
        hyp=cfg,  # è¶…å‚æ•°é…ç½®
        rect=cfg.rect or rect,  # æ˜¯å¦ä½¿ç”¨çŸ©å½¢æ‰¹æ¬¡
        cache=cfg.cache or None,  # ç¼“å­˜è®¾ç½®
        single_cls=cfg.single_cls or False,  # æ˜¯å¦ä½¿ç”¨å•ç±»æ£€æµ‹
        stride=int(stride),  # æ­¥å¹…
        pad=0.0 if mode == "train" else 0.5,  # å¡«å……è®¾ç½®
        prefix=colorstr(f"{mode}: "),  # å‰ç¼€
        task=cfg.task,  # ä»»åŠ¡ç±»å‹
        classes=cfg.classes,  # ç±»åˆ«
        data=data,  # æ•°æ®é…ç½®
        fraction=cfg.fraction if mode == "train" else 1.0,  # è®­ç»ƒæ—¶çš„æ•°æ®æ¯”ä¾‹
    )


def build_dataloader(dataset, batch, workers, shuffle=True, rank=-1):
    """è¿”å›ç”¨äºè®­ç»ƒæˆ–éªŒè¯é›†çš„ InfiniteDataLoader æˆ– DataLoaderã€‚"""
    batch = min(batch, len(dataset))  # ç¡®ä¿æ‰¹æ¬¡å¤§å°ä¸è¶…è¿‡æ•°æ®é›†å¤§å°
    nd = torch.cuda.device_count()  # è·å– CUDA è®¾å¤‡æ•°é‡
    nw = min([os.cpu_count() // max(nd, 1), workers])  # è®¡ç®—å·¥ä½œçº¿ç¨‹æ•°é‡
    sampler = None if rank == -1 else distributed.DistributedSampler(dataset, shuffle=shuffle)  # åˆ†å¸ƒå¼é‡‡æ ·å™¨
    generator = torch.Generator()  # åˆ›å»ºéšæœºæ•°ç”Ÿæˆå™¨
    generator.manual_seed(6148914691236517205 + RANK)  # è®¾ç½®éšæœºç§å­
    return InfiniteDataLoader(
        dataset=dataset,  # æ•°æ®é›†
        batch_size=batch,  # æ‰¹æ¬¡å¤§å°
        shuffle=shuffle and sampler is None,  # æ˜¯å¦æ‰“ä¹±æ•°æ®
        num_workers=nw,  # å·¥ä½œçº¿ç¨‹æ•°é‡
        sampler=sampler,  # é‡‡æ ·å™¨
        pin_memory=PIN_MEMORY,  # æ˜¯å¦ä½¿ç”¨å›ºå®šå†…å­˜
        collate_fn=getattr(dataset, "collate_fn", None),  # åˆå¹¶å‡½æ•°
        worker_init_fn=seed_worker,  # å·¥ä½œçº¿ç¨‹åˆå§‹åŒ–å‡½æ•°
        generator=generator,  # éšæœºæ•°ç”Ÿæˆå™¨
    )


def check_source(source):
    """æ£€æŸ¥è¾“å…¥æºç±»å‹å¹¶è¿”å›ç›¸åº”çš„æ ‡å¿—å€¼ã€‚"""
    webcam, screenshot, from_img, in_memory, tensor = False, False, False, False, False
    if isinstance(source, (str, int, Path)):  # å¦‚æœæ˜¯å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–è·¯å¾„
        source = str(source)
        is_file = Path(source).suffix[1:] in (IMG_FORMATS + VID_FORMATS)  # æ£€æŸ¥æ˜¯å¦ä¸ºæ–‡ä»¶
        is_url = source.lower().startswith(("https://", "http://", "rtsp://", "rtmp://", "tcp://"))  # æ£€æŸ¥æ˜¯å¦ä¸º URL
        webcam = source.isnumeric() or source.endswith(".streams") or (is_url and not is_file)  # æ£€æŸ¥æ˜¯å¦ä¸ºç½‘ç»œæ‘„åƒå¤´
        screenshot = source.lower() == "screen"  # æ£€æŸ¥æ˜¯å¦ä¸ºå±å¹•æˆªå›¾
        if is_url and is_file:
            source = check_file(source)  # ä¸‹è½½æ–‡ä»¶
    elif isinstance(source, LOADERS):
        in_memory = True  # å¦‚æœæ˜¯åŠ è½½å™¨ï¼Œåˆ™åœ¨å†…å­˜ä¸­
    elif isinstance(source, (list, tuple)):
        source = autocast_list(source)  # å°†åˆ—è¡¨å…ƒç´ è½¬æ¢ä¸º PIL æˆ– np æ•°ç»„
        from_img = True
    elif isinstance(source, (Image.Image, np.ndarray)):
        from_img = True  # å¦‚æœæ˜¯å›¾åƒæˆ–æ•°ç»„
    elif isinstance(source, torch.Tensor):
        tensor = True  # å¦‚æœæ˜¯å¼ é‡
    else:
        raise TypeError("ä¸æ”¯æŒçš„å›¾åƒç±»å‹ã€‚")

    return source, webcam, screenshot, from_img, in_memory, tensor


def load_inference_source(source=None, imgsz=640, vid_stride=1, buffer=False):
    """
    åŠ è½½ç”¨äºç›®æ ‡æ£€æµ‹çš„æ¨ç†æºå¹¶åº”ç”¨å¿…è¦çš„è½¬æ¢ã€‚

    å‚æ•°:
        source (str, Path, Tensor, PIL.Image, np.ndarray): è¾“å…¥æºã€‚
        imgsz (int, optional): æ¨ç†å›¾åƒå¤§å°ï¼Œé»˜è®¤ä¸º 640ã€‚
        vid_stride (int, optional): è§†é¢‘æºçš„å¸§é—´éš”ï¼Œé»˜è®¤ä¸º 1ã€‚
        buffer (bool, optional): æ˜¯å¦ç¼“å†²æµå¸§ï¼Œé»˜è®¤ä¸º Falseã€‚

    è¿”å›:
        dataset (Dataset): æŒ‡å®šè¾“å…¥æºçš„æ•°æ®é›†å¯¹è±¡ã€‚
    """
    source, webcam, screenshot, from_img, in_memory, tensor = check_source(source)  # æ£€æŸ¥æºç±»å‹
    source_type = source.source_type if in_memory else SourceTypes(webcam, screenshot, from_img, tensor)  # ç¡®å®šæºç±»å‹

    # æ ¹æ®æºç±»å‹åŠ è½½æ•°æ®é›†
    if tensor:
        dataset = LoadTensor(source)  # å¦‚æœæ˜¯å¼ é‡
    elif in_memory:
        dataset = source  # å¦‚æœåœ¨å†…å­˜ä¸­
    elif webcam:
        dataset = LoadStreams(source, imgsz=imgsz, vid_stride=vid_stride, buffer=buffer)  # å¦‚æœæ˜¯ç½‘ç»œæ‘„åƒå¤´
    elif screenshot:
        dataset = LoadScreenshots(source, imgsz=imgsz)  # å¦‚æœæ˜¯å±å¹•æˆªå›¾
    elif from_img:
        dataset = LoadPilAndNumpy(source, imgsz=imgsz)  # å¦‚æœæ˜¯å›¾åƒ
    else:
        dataset = LoadImages(source, imgsz=imgsz, vid_stride=vid_stride)  # é»˜è®¤åŠ è½½å›¾åƒ

    # å°†æºç±»å‹é™„åŠ åˆ°æ•°æ®é›†
    setattr(dataset, "source_type", source_type)

    return dataset  # è¿”å›æ•°æ®é›†å¯¹è±¡
```

è¿™æ®µä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†ä¸»è¦åŒ…æ‹¬è‡ªå®šä¹‰çš„æ•°æ®åŠ è½½å™¨ `InfiniteDataLoader` å’Œ `_RepeatSampler`ï¼Œç”¨äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸æ–­é‡å¤ä½¿ç”¨æ•°æ®ã€‚è¿˜åŒ…æ‹¬æ„å»º YOLO æ•°æ®é›†å’Œæ•°æ®åŠ è½½å™¨çš„å‡½æ•°ï¼Œä»¥åŠæ£€æŸ¥è¾“å…¥æºç±»å‹å’ŒåŠ è½½æ¨ç†æºçš„åŠŸèƒ½ã€‚æ¯ä¸ªå‡½æ•°å’Œç±»éƒ½æœ‰è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼Œè§£é‡Šå…¶åŠŸèƒ½å’Œå‚æ•°ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ç”¨äºæ„å»ºå’Œç®¡ç†YOLOï¼ˆYou Only Look Onceï¼‰æ¨¡å‹çš„æ•°æ®åŠ è½½å™¨ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†æ•°æ®é›†çš„åŠ è½½å’Œé¢„å¤„ç†ï¼Œä»¥ä¾¿äºæ¨¡å‹çš„è®­ç»ƒå’Œæ¨ç†ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿç›¸å…³çš„åº“ã€éšæœºæ•°ç”Ÿæˆåº“ã€è·¯å¾„å¤„ç†åº“ã€NumPyã€PyTorchä»¥åŠä¸€äº›ä¸æ•°æ®åŠ è½½ç›¸å…³çš„æ¨¡å—ã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º`InfiniteDataLoader`çš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ªPyTorchçš„`DataLoader`ï¼Œå®ç°äº†ä¸€ä¸ªå¯ä»¥æ— é™å¾ªç¯ä½¿ç”¨å·¥ä½œçº¿ç¨‹çš„æ•°æ®åŠ è½½å™¨ã€‚è¿™ä¸ªç±»é‡å†™äº†`__len__`å’Œ`__iter__`æ–¹æ³•ï¼Œä½¿å¾—åœ¨è¿­ä»£æ—¶å¯ä»¥ä¸æ–­åœ°é‡å¤ä½¿ç”¨æ•°æ®ã€‚

åœ¨`InfiniteDataLoader`å†…éƒ¨ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªåä¸º`_RepeatSampler`çš„ç±»ï¼Œç”¨äºå®ç°æ— é™é‡å¤çš„é‡‡æ ·å™¨ã€‚è¿™ä¸ªé‡‡æ ·å™¨ä¼šä¸æ–­åœ°è¿­ä»£ç»™å®šçš„é‡‡æ ·å™¨ï¼Œç¡®ä¿æ•°æ®å¯ä»¥æŒç»­æä¾›ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ª`seed_worker`å‡½æ•°ï¼Œç”¨äºè®¾ç½®æ•°æ®åŠ è½½å™¨å·¥ä½œçº¿ç¨‹çš„éšæœºç§å­ï¼Œä»¥ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„éšæœºæ€§ä¸€è‡´æ€§ã€‚

`build_yolo_dataset`å‡½æ•°ç”¨äºæ„å»ºYOLOæ•°æ®é›†ï¼Œæ¥æ”¶é…ç½®å‚æ•°ã€å›¾åƒè·¯å¾„ã€æ‰¹é‡å¤§å°ç­‰ä¿¡æ¯ï¼Œå¹¶è¿”å›ä¸€ä¸ª`YOLODataset`å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°ä¼šæ ¹æ®è®­ç»ƒæ¨¡å¼å’Œå…¶ä»–å‚æ•°æ¥å†³å®šæ˜¯å¦è¿›è¡Œæ•°æ®å¢å¼ºã€æ˜¯å¦ä½¿ç”¨çŸ©å½¢æ‰¹æ¬¡ç­‰ã€‚

`build_dataloader`å‡½æ•°åˆ™æ˜¯ç”¨äºè¿”å›ä¸€ä¸ª`InfiniteDataLoader`æˆ–æ™®é€šçš„`DataLoader`ï¼Œå®ƒä¼šæ ¹æ®æ•°æ®é›†çš„å¤§å°ã€å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€æ˜¯å¦è¿›è¡Œæ´—ç‰Œç­‰å‚æ•°æ¥é…ç½®æ•°æ®åŠ è½½å™¨ã€‚å®ƒè¿˜ä¼šè€ƒè™‘åˆ†å¸ƒå¼è®­ç»ƒçš„æƒ…å†µï¼Œä½¿ç”¨`DistributedSampler`æ¥å¤„ç†æ•°æ®ã€‚

`check_source`å‡½æ•°ç”¨äºæ£€æŸ¥è¾“å…¥æ•°æ®æºçš„ç±»å‹ï¼Œåˆ¤æ–­å®ƒæ˜¯æ–‡ä»¶ã€URLã€æ‘„åƒå¤´ã€å›¾åƒã€NumPyæ•°ç»„è¿˜æ˜¯å¼ é‡ï¼Œå¹¶è¿”å›ç›¸åº”çš„æ ‡å¿—å€¼ï¼Œä»¥ä¾¿åç»­å¤„ç†ã€‚

æœ€åï¼Œ`load_inference_source`å‡½æ•°ç”¨äºåŠ è½½æ¨ç†æºï¼Œæ¥æ”¶è¾“å…¥æºã€å›¾åƒå¤§å°ã€è§†é¢‘å¸§é—´éš”ç­‰å‚æ•°ï¼Œå¹¶æ ¹æ®æºçš„ç±»å‹åˆ›å»ºç›¸åº”çš„æ•°æ®é›†å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°æ”¯æŒå¤šç§è¾“å…¥æºç±»å‹ï¼ŒåŒ…æ‹¬å¼ é‡ã€å›¾åƒã€è§†é¢‘æµç­‰ï¼Œå¹¶åœ¨åˆ›å»ºçš„æ•°æ®é›†ä¸­é™„åŠ æºç±»å‹çš„ä¿¡æ¯ã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªçµæ´»çš„æ•°æ®åŠ è½½æœºåˆ¶ï¼Œä»¥æ”¯æŒYOLOæ¨¡å‹çš„è®­ç»ƒå’Œæ¨ç†ï¼Œç¡®ä¿æ•°æ®èƒ½å¤Ÿé«˜æ•ˆä¸”æ­£ç¡®åœ°è¢«åŠ è½½å’Œå¤„ç†ã€‚

#### 11.4 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\engine\trainer.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦å…³æ³¨è®­ç»ƒæ¨¡å‹çš„åŸºæœ¬æµç¨‹å’Œé‡è¦æ–¹æ³•ã€‚

```python
class BaseTrainer:
    """
    BaseTrainer ç±»ç”¨äºåˆ›å»ºè®­ç»ƒå™¨çš„åŸºç±»ï¼Œè´Ÿè´£æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """
        åˆå§‹åŒ– BaseTrainer ç±»ã€‚

        å‚æ•°:
            cfg (str, optional): é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸º DEFAULT_CFGã€‚
            overrides (dict, optional): é…ç½®è¦†ç›–ï¼Œé»˜è®¤ä¸º Noneã€‚
        """
        # è·å–é…ç½®
        self.args = get_cfg(cfg, overrides)
        self.check_resume(overrides)  # æ£€æŸ¥æ˜¯å¦éœ€è¦ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒ
        self.device = select_device(self.args.device, self.args.batch)  # é€‰æ‹©è®­ç»ƒè®¾å¤‡
        self.model = None  # æ¨¡å‹å®ä¾‹
        self.trainset, self.testset = self.get_dataset(self.args.data)  # è·å–è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†
        self.optimizer = None  # ä¼˜åŒ–å™¨
        self.scheduler = None  # å­¦ä¹ ç‡è°ƒåº¦å™¨
        self.best_fitness = None  # æœ€ä½³é€‚åº”åº¦
        self.start_epoch = 0  # å¼€å§‹è®­ç»ƒçš„ epoch

    def train(self):
        """å¼€å§‹è®­ç»ƒè¿‡ç¨‹ã€‚"""
        world_size = self._get_world_size()  # è·å–ä¸–ç•Œå¤§å°ï¼ˆGPU æ•°é‡ï¼‰

        if world_size > 1 and 'LOCAL_RANK' not in os.environ:
            # å¦‚æœæ˜¯å¤š GPU è®­ç»ƒï¼Œç”Ÿæˆ DDP å‘½ä»¤å¹¶è¿è¡Œ
            cmd, file = generate_ddp_command(world_size, self)
            subprocess.run(cmd, check=True)  # è¿è¡Œå‘½ä»¤
            ddp_cleanup(self, str(file))  # æ¸…ç† DDP ç›¸å…³çš„è®¾ç½®
        else:
            self._do_train(world_size)  # å• GPU è®­ç»ƒ

    def _do_train(self, world_size=1):
        """æ‰§è¡Œè®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ¨¡å‹è®­ç»ƒå’ŒéªŒè¯ã€‚"""
        self._setup_train(world_size)  # è®¾ç½®è®­ç»ƒå‚æ•°å’Œæ•°æ®åŠ è½½å™¨

        for epoch in range(self.start_epoch, self.args.epochs):
            self.model.train()  # è®¾ç½®æ¨¡å‹ä¸ºè®­ç»ƒæ¨¡å¼
            for i, batch in enumerate(self.train_loader):  # éå†è®­ç»ƒæ•°æ®
                self.optimizer.zero_grad()  # æ¸…ç©ºæ¢¯åº¦
                loss, loss_items = self.model(batch)  # å‰å‘ä¼ æ’­è®¡ç®—æŸå¤±
                loss.backward()  # åå‘ä¼ æ’­
                self.optimizer.step()  # æ›´æ–°å‚æ•°

            # æ¯ä¸ª epoch ç»“æŸåè¿›è¡ŒéªŒè¯
            if (epoch + 1) % self.args.val_interval == 0:
                self.validate()  # éªŒè¯æ¨¡å‹æ€§èƒ½

    def validate(self):
        """åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚"""
        self.model.eval()  # è®¾ç½®æ¨¡å‹ä¸ºè¯„ä¼°æ¨¡å¼
        with torch.no_grad():  # ä¸è®¡ç®—æ¢¯åº¦
            for batch in self.test_loader:
                # è¿›è¡ŒéªŒè¯é€»è¾‘
                pass  # å…·ä½“éªŒè¯é€»è¾‘çœç•¥

    def _setup_train(self, world_size):
        """è®¾ç½®è®­ç»ƒæ‰€éœ€çš„å‚æ•°å’Œæ•°æ®åŠ è½½å™¨ã€‚"""
        self.model = self.setup_model()  # è®¾ç½®æ¨¡å‹
        self.optimizer = self.build_optimizer(self.model)  # æ„å»ºä¼˜åŒ–å™¨
        self.train_loader = self.get_dataloader(self.trainset)  # è·å–è®­ç»ƒæ•°æ®åŠ è½½å™¨
        self.test_loader = self.get_dataloader(self.testset)  # è·å–æµ‹è¯•æ•°æ®åŠ è½½å™¨

    def build_optimizer(self, model):
        """æ„å»ºä¼˜åŒ–å™¨ã€‚"""
        return optim.Adam(model.parameters(), lr=self.args.lr)  # ä½¿ç”¨ Adam ä¼˜åŒ–å™¨

    def get_dataloader(self, dataset):
        """è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        return torch.utils.data.DataLoader(dataset, batch_size=self.args.batch, shuffle=True)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def get_dataset(self, data):
        """ä»æ•°æ®å­—å…¸ä¸­è·å–è®­ç»ƒå’ŒéªŒè¯è·¯å¾„ã€‚"""
        return data['train'], data.get('val') or data.get('test')  # è¿”å›è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†è·¯å¾„

    def check_resume(self, overrides):
        """æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¢å¤æ£€æŸ¥ç‚¹å¹¶æ›´æ–°å‚æ•°ã€‚"""
        resume = self.args.resume
        if resume:
            # æ£€æŸ¥æ¢å¤è·¯å¾„æ˜¯å¦å­˜åœ¨
            pass  # å…·ä½“å®ç°çœç•¥

    def setup_model(self):
        """åŠ è½½æˆ–åˆ›å»ºæ¨¡å‹ã€‚"""
        # å…·ä½“å®ç°çœç•¥
        pass
```

### ä»£ç è¯´æ˜
1. **BaseTrainer ç±»**: è¿™æ˜¯ä¸€ä¸ªè®­ç»ƒå™¨çš„åŸºç±»ï¼Œè´Ÿè´£ç®¡ç†è®­ç»ƒè¿‡ç¨‹çš„å„ä¸ªæ–¹é¢ã€‚
2. **åˆå§‹åŒ–æ–¹æ³• (`__init__`)**: åˆå§‹åŒ–é…ç½®ã€è®¾å¤‡é€‰æ‹©ã€æ•°æ®é›†è·å–ç­‰ã€‚
3. **è®­ç»ƒæ–¹æ³• (`train`)**: å¼€å§‹è®­ç»ƒè¿‡ç¨‹ï¼Œæ”¯æŒå¤š GPU è®­ç»ƒã€‚
4. **è®­ç»ƒè¿‡ç¨‹ (`_do_train`)**: åŒ…å«è®­ç»ƒå¾ªç¯å’ŒéªŒè¯é€»è¾‘ã€‚
5. **éªŒè¯æ–¹æ³• (`validate`)**: åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚
6. **è®¾ç½®è®­ç»ƒ (`_setup_train`)**: è®¾ç½®æ¨¡å‹ã€ä¼˜åŒ–å™¨å’Œæ•°æ®åŠ è½½å™¨ã€‚
7. **æ„å»ºä¼˜åŒ–å™¨ (`build_optimizer`)**: åˆ›å»ºä¼˜åŒ–å™¨å®ä¾‹ã€‚
8. **è·å–æ•°æ®åŠ è½½å™¨ (`get_dataloader`)**: è¿”å›è®­ç»ƒæˆ–æµ‹è¯•æ•°æ®çš„åŠ è½½å™¨ã€‚
9. **æ£€æŸ¥æ¢å¤ (`check_resume`)**: æ£€æŸ¥æ˜¯å¦éœ€è¦ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒã€‚
10. **è®¾ç½®æ¨¡å‹ (`setup_model`)**: åŠ è½½æˆ–åˆ›å»ºæ¨¡å‹çš„é€»è¾‘ã€‚

ä»¥ä¸Šä»£ç å’Œæ³¨é‡Šæä¾›äº†è®­ç»ƒè¿‡ç¨‹çš„æ ¸å¿ƒé€»è¾‘ï¼Œé€‚åˆç”¨äºç†è§£å’Œæ‰©å±•è®­ç»ƒå™¨çš„åŠŸèƒ½ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒYOLOv8æ¨¡å‹çš„åŸºç¡€ç±»`BaseTrainer`çš„å®ç°ï¼ŒåŒ…å«äº†è®­ç»ƒè¿‡ç¨‹ä¸­çš„å„ä¸ªç¯èŠ‚å’Œç›¸å…³é…ç½®ã€‚æ–‡ä»¶çš„å¼€å¤´åŒ…å«äº†ä½¿ç”¨è¯´æ˜ï¼ŒæŒ‡æ˜äº†å¦‚ä½•é€šè¿‡å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨è®­ç»ƒã€‚

åœ¨æ–‡ä»¶ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€æ–‡ä»¶æ“ä½œã€æ—¶é—´å¤„ç†ã€æ·±åº¦å­¦ä¹ ç›¸å…³çš„PyTorchåº“ç­‰ã€‚æ¥ç€ï¼Œå®šä¹‰äº†`BaseTrainer`ç±»ï¼Œè¯¥ç±»åŒ…å«äº†è®­ç»ƒæ¨¡å‹æ‰€éœ€çš„å¤šä¸ªå±æ€§å’Œæ–¹æ³•ã€‚

ç±»çš„æ„é€ å‡½æ•°`__init__`åˆå§‹åŒ–äº†ä¸€äº›åŸºæœ¬å‚æ•°ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€è®¾å¤‡é€‰æ‹©ã€æ¨¡å‹å’Œæ•°æ®é›†çš„å‡†å¤‡ç­‰ã€‚å®ƒä¼šæ ¹æ®ä¼ å…¥çš„é…ç½®æ–‡ä»¶å’Œé‡å†™å‚æ•°æ¥è®¾ç½®è®­ç»ƒçš„ç›¸å…³å‚æ•°ï¼Œå¹¶åˆ›å»ºä¿å­˜ç»“æœçš„ç›®å½•ã€‚å®ƒè¿˜ä¼šæ£€æŸ¥æ•°æ®é›†çš„æœ‰æ•ˆæ€§ï¼Œå¹¶æ ¹æ®ä»»åŠ¡ç±»å‹ï¼ˆåˆ†ç±»ã€æ£€æµ‹ç­‰ï¼‰æ¥åŠ è½½ç›¸åº”çš„æ•°æ®é›†ã€‚

`BaseTrainer`ç±»ä¸­åŒ…å«å¤šä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚`train`æ–¹æ³•ç”¨äºå¯åŠ¨è®­ç»ƒè¿‡ç¨‹ï¼Œ`_setup_ddp`æ–¹æ³•ç”¨äºè®¾ç½®åˆ†å¸ƒå¼æ•°æ®å¹¶è¡Œè®­ç»ƒçš„å‚æ•°ï¼Œ`_setup_train`æ–¹æ³•åˆ™ç”¨äºæ„å»ºæ•°æ®åŠ è½½å™¨å’Œä¼˜åŒ–å™¨ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹ä¼šåœ¨æ¯ä¸ªepochä¸­è¿›è¡Œè®­ç»ƒå’ŒéªŒè¯ï¼Œå¹¶æ ¹æ®è®¾å®šçš„æ¡ä»¶ä¿å­˜æ¨¡å‹çš„æ£€æŸ¥ç‚¹ã€‚

è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†è‡ªåŠ¨æ··åˆç²¾åº¦ï¼ˆAMPï¼‰æ¥æé«˜è®­ç»ƒæ•ˆç‡ï¼Œå¹¶åœ¨æ¯ä¸ªbatchçš„è®­ç»ƒä¸­è¿›è¡ŒæŸå¤±è®¡ç®—å’Œåå‘ä¼ æ’­ã€‚é€šè¿‡`optimizer_step`æ–¹æ³•æ‰§è¡Œä¼˜åŒ–æ­¥éª¤ï¼Œå¹¶åœ¨æ¯ä¸ªepochç»“æŸæ—¶è¿›è¡ŒéªŒè¯ï¼Œæ›´æ–°æ¨¡å‹çš„çŠ¶æ€ã€‚

æ­¤å¤–ï¼Œç±»ä¸­è¿˜å®šä¹‰äº†ä¸€äº›ç”¨äºå¤„ç†å›è°ƒã€ä¿å­˜æ¨¡å‹ã€åŠ è½½æ•°æ®é›†å’Œæ„å»ºä¼˜åŒ–å™¨çš„æ–¹æ³•ã€‚é€šè¿‡å›è°ƒæœºåˆ¶ï¼Œå¯ä»¥åœ¨è®­ç»ƒçš„ä¸åŒé˜¶æ®µæ‰§è¡Œç‰¹å®šçš„æ“ä½œï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€ç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ ·æœ¬ç­‰ã€‚

æœ€åï¼Œç±»ä¸­è¿˜åŒ…å«äº†ä¸€äº›ç”¨äºä¿å­˜è®­ç»ƒæŒ‡æ ‡ã€ç»˜åˆ¶è®­ç»ƒå›¾è¡¨å’Œè¿›è¡Œæœ€ç»ˆè¯„ä¼°çš„æ–¹æ³•ã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„YOLOv8æ¨¡å‹è®­ç»ƒæ¡†æ¶ï¼Œæ”¯æŒå¤šç§è®­ç»ƒé…ç½®å’Œå‚æ•°è°ƒæ•´ï¼Œé€‚ç”¨äºæ·±åº¦å­¦ä¹ ç ”ç©¶å’Œåº”ç”¨ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„æ•°æ®å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼ä¸º'train'æˆ–'val'
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œä»…åˆå§‹åŒ–æ•°æ®é›†ä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦è®­ç»ƒ
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©ä¸€ä¸ªæ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœç¼©æ”¾å› å­ä¸ä¸º1
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡ä¸­çš„å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›ä¸€ä¸ªYOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›ç”¨äºYOLOæ¨¡å‹éªŒè¯çš„DetectionValidatorã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )  # è¿”å›éªŒè¯å™¨

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šè¯¥ç±»è´Ÿè´£YOLOæ¨¡å‹çš„è®­ç»ƒï¼Œç»§æ‰¿è‡ª`BaseTrainer`ï¼Œå°è£…äº†è®­ç»ƒè¿‡ç¨‹ä¸­æ‰€éœ€çš„å„ç§åŠŸèƒ½ã€‚
2. **build_datasetæ–¹æ³•**ï¼šç”¨äºæ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ï¼Œèƒ½å¤Ÿæ ¹æ®æ¨¡å¼è‡ªå®šä¹‰æ•°æ®å¢å¼ºã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒï¼Œå¹¶æ ¹æ®æ¨¡å¼é€‰æ‹©æ˜¯å¦æ‰“ä¹±æ•°æ®ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¯é€‰çš„å¤šå°ºåº¦è°ƒæ•´ã€‚
5. **get_modelæ–¹æ³•**ï¼šè¿”å›ä¸€ä¸ªYOLOæ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºæ¨¡å‹éªŒè¯çš„éªŒè¯å™¨ï¼ŒåŒ…å«æŸå¤±åç§°çš„å®šä¹‰ã€‚
7. **plot_training_samplesæ–¹æ³•**ï¼šç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®ç°ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†å¤šä¸ªæ–¹æ³•ï¼Œä¸»è¦ç”¨äºæ„å»ºæ•°æ®é›†ã€è·å–æ•°æ®åŠ è½½å™¨ã€é¢„å¤„ç†å›¾åƒã€è®¾ç½®æ¨¡å‹å±æ€§ã€è·å–æ¨¡å‹ã€è¿›è¡ŒéªŒè¯ã€è®°å½•æŸå¤±ã€æ˜¾ç¤ºè®­ç»ƒè¿›åº¦ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚

é¦–å…ˆï¼Œ`DetectionTrainer` ç±»çš„æ„é€ å‡½æ•°å®šä¹‰äº†å¦‚ä½•æ„å»º YOLO æ•°æ®é›†ã€‚`build_dataset` æ–¹æ³•æ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ï¼Œåˆ©ç”¨ `build_yolo_dataset` å‡½æ•°åˆ›å»ºæ•°æ®é›†ã€‚è¿™é‡Œä½¿ç”¨äº†æ¨¡å‹çš„æ­¥å¹…æ¥ç¡®ä¿å›¾åƒå°ºå¯¸çš„åˆç†æ€§ã€‚

`get_dataloader` æ–¹æ³•åˆ™è´Ÿè´£æ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚å®ƒæ ¹æ®æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å†³å®šæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶è®¾ç½®å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œåœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶ï¼Œå®ƒç¡®ä¿æ•°æ®é›†åªåˆå§‹åŒ–ä¸€æ¬¡ã€‚

åœ¨å›¾åƒé¢„å¤„ç†æ–¹é¢ï¼Œ`preprocess_batch` æ–¹æ³•å°†å›¾åƒç¼©æ”¾åˆ°åˆé€‚çš„å°ºå¯¸ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ï¼Œä¾¿äºåç»­å¤„ç†ã€‚è¿™é‡Œè¿˜å®ç°äº†å¤šå°ºåº¦è®­ç»ƒçš„åŠŸèƒ½ï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒå¤§å°æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®å¤„ç†ç‰¹å®šæ•°æ®é›†ã€‚

è·å– YOLO æ£€æµ‹æ¨¡å‹çš„åŠŸèƒ½ç”± `get_model` æ–¹æ³•å®ç°ï¼Œè¯¥æ–¹æ³•æ ¹æ®é…ç½®æ–‡ä»¶å’Œæƒé‡åŠ è½½æ¨¡å‹ã€‚`get_validator` æ–¹æ³•åˆ™è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯æ¨¡å‹æ€§èƒ½çš„éªŒè¯å™¨ã€‚

åœ¨æŸå¤±è®°å½•æ–¹é¢ï¼Œ`label_loss_items` æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«è®­ç»ƒæŸå¤±é¡¹çš„å­—å…¸ï¼Œä¾¿äºåç»­åˆ†æå’Œç›‘æ§è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ€§èƒ½ã€‚

`progress_string` æ–¹æ³•æ ¼å¼åŒ–è®­ç»ƒè¿›åº¦çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºå½“å‰çš„è®­ç»ƒè½®æ¬¡ã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ï¼Œä¾¿äºç”¨æˆ·è·Ÿè¸ªè®­ç»ƒè¿›åº¦ã€‚

æ­¤å¤–ï¼Œ`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œå¸®åŠ©å¯è§†åŒ–è®­ç»ƒæ•°æ®çš„è´¨é‡ã€‚æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ™ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œæ ‡ç­¾ï¼Œæä¾›æ›´ç›´è§‚çš„è®­ç»ƒç»“æœå±•ç¤ºã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº† YOLO æ¨¡å‹è®­ç»ƒçš„å„ä¸ªç¯èŠ‚ï¼Œæ¶µç›–äº†æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ç›®æ ‡æ£€æµ‹è®­ç»ƒæ¡†æ¶ã€‚

#### 11.6 code\ultralytics\models\yolo\model.py

```python
# å¯¼å…¥æ‰€éœ€çš„æ¨¡å—å’Œç±»
from ultralytics.engine.model import Model
from ultralytics.models import yolo
from ultralytics.nn.tasks import ClassificationModel, DetectionModel, OBBModel, PoseModel, SegmentationModel

class YOLO(Model):
    """YOLO (You Only Look Once) ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®šä¹‰ç±»ã€‚"""

    @property
    def task_map(self):
        """å°†ä»»åŠ¡ç±»å‹æ˜ å°„åˆ°ç›¸åº”çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚"""
        return {
            "classify": {  # åˆ†ç±»ä»»åŠ¡
                "model": ClassificationModel,  # åˆ†ç±»æ¨¡å‹
                "trainer": yolo.classify.ClassificationTrainer,  # åˆ†ç±»è®­ç»ƒå™¨
                "validator": yolo.classify.ClassificationValidator,  # åˆ†ç±»éªŒè¯å™¨
                "predictor": yolo.classify.ClassificationPredictor,  # åˆ†ç±»é¢„æµ‹å™¨
            },
            "detect": {  # æ£€æµ‹ä»»åŠ¡
                "model": DetectionModel,  # æ£€æµ‹æ¨¡å‹
                "trainer": yolo.detect.DetectionTrainer,  # æ£€æµ‹è®­ç»ƒå™¨
                "validator": yolo.detect.DetectionValidator,  # æ£€æµ‹éªŒè¯å™¨
                "predictor": yolo.detect.DetectionPredictor,  # æ£€æµ‹é¢„æµ‹å™¨
            },
            "segment": {  # åˆ†å‰²ä»»åŠ¡
                "model": SegmentationModel,  # åˆ†å‰²æ¨¡å‹
                "trainer": yolo.segment.SegmentationTrainer,  # åˆ†å‰²è®­ç»ƒå™¨
                "validator": yolo.segment.SegmentationValidator,  # åˆ†å‰²éªŒè¯å™¨
                "predictor": yolo.segment.SegmentationPredictor,  # åˆ†å‰²é¢„æµ‹å™¨
            },
            "pose": {  # å§¿æ€ä¼°è®¡ä»»åŠ¡
                "model": PoseModel,  # å§¿æ€æ¨¡å‹
                "trainer": yolo.pose.PoseTrainer,  # å§¿æ€è®­ç»ƒå™¨
                "validator": yolo.pose.PoseValidator,  # å§¿æ€éªŒè¯å™¨
                "predictor": yolo.pose.PosePredictor,  # å§¿æ€é¢„æµ‹å™¨
            },
            "obb": {  # æ–¹å‘è¾¹ç•Œæ¡†ä»»åŠ¡
                "model": OBBModel,  # æ–¹å‘è¾¹ç•Œæ¡†æ¨¡å‹
                "trainer": yolo.obb.OBBTrainer,  # æ–¹å‘è¾¹ç•Œæ¡†è®­ç»ƒå™¨
                "validator": yolo.obb.OBBValidator,  # æ–¹å‘è¾¹ç•Œæ¡†éªŒè¯å™¨
                "predictor": yolo.obb.OBBPredictor,  # æ–¹å‘è¾¹ç•Œæ¡†é¢„æµ‹å™¨
            },
        }
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼šé¦–å…ˆå¯¼å…¥äº†éœ€è¦çš„æ¨¡å—å’Œç±»ï¼ŒåŒ…æ‹¬æ¨¡å‹çš„åŸºç±»å’Œä¸åŒä»»åŠ¡çš„æ¨¡å‹ç±»ã€‚
2. **YOLOç±»**ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º`YOLO`çš„ç±»ï¼Œç»§æ‰¿è‡ª`Model`ï¼Œè¡¨ç¤ºYOLOç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚
3. **task_mapå±æ€§**ï¼šè¯¥å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œæ˜ å°„ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼ˆå¦‚åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€å§¿æ€ä¼°è®¡å’Œæ–¹å‘è¾¹ç•Œæ¡†ï¼‰åˆ°ç›¸åº”çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ã€‚è¿™ä½¿å¾—æ¨¡å‹å¯ä»¥æ ¹æ®ä»»åŠ¡ç±»å‹çµæ´»é€‰æ‹©ç›¸åº”çš„ç»„ä»¶ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `YOLO` çš„ç±»ï¼Œç»§æ‰¿è‡ª `Model` ç±»ï¼Œä¸»è¦ç”¨äºå®ç° YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚æ–‡ä»¶å¼€å¤´åŒ…å«äº†ç‰ˆæƒä¿¡æ¯ï¼Œè¡¨æ˜è¯¥ä»£ç éµå¾ª AGPL-3.0 è®¸å¯è¯ã€‚

åœ¨ `YOLO` ç±»ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º `task_map` çš„å±æ€§æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®æ˜¯ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼ˆå¦‚åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€å§¿æ€ä¼°è®¡å’Œæ–¹å‘è¾¹ç•Œæ¡†ï¼‰ï¼Œæ¯ä¸ªé”®å¯¹åº”çš„å€¼åˆæ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†ä¸è¯¥ä»»åŠ¡ç›¸å…³çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚

å…·ä½“æ¥è¯´ï¼Œ`task_map` å­—å…¸çš„ç»“æ„å¦‚ä¸‹ï¼š

- å¯¹äº "classify" ä»»åŠ¡ï¼Œæ˜ å°„åˆ° `ClassificationModel` åŠå…¶ç›¸åº”çš„è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹ç±»ã€‚
- å¯¹äº "detect" ä»»åŠ¡ï¼Œæ˜ å°„åˆ° `DetectionModel` åŠå…¶ç›¸åº”çš„è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹ç±»ã€‚
- å¯¹äº "segment" ä»»åŠ¡ï¼Œæ˜ å°„åˆ° `SegmentationModel` åŠå…¶ç›¸åº”çš„è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹ç±»ã€‚
- å¯¹äº "pose" ä»»åŠ¡ï¼Œæ˜ å°„åˆ° `PoseModel` åŠå…¶ç›¸åº”çš„è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹ç±»ã€‚
- å¯¹äº "obb" ä»»åŠ¡ï¼Œæ˜ å°„åˆ° `OBBModel` åŠå…¶ç›¸åº”çš„è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹ç±»ã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ`YOLO` ç±»å¯ä»¥æ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹çµæ´»åœ°é€‰æ‹©ç›¸åº”çš„æ¨¡å‹å’Œå·¥å…·ï¼Œä½¿å¾—åœ¨è¿›è¡Œç›®æ ‡æ£€æµ‹åŠå…¶ä»–ç›¸å…³ä»»åŠ¡æ—¶ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œæ‰©å±•å’Œç®¡ç†ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹ç®—æ³•çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ŒåŒ…å«äº†å¤šä¸ªæ¨¡å—å’Œå·¥å…·ï¼Œç”¨äºæ¨¡å‹çš„è®­ç»ƒã€æ¨ç†å’Œæ•°æ®å¤„ç†ã€‚é¡¹ç›®çš„æ•´ä½“æ¶æ„è®¾è®¡çµæ´»ä¸”æ¨¡å—åŒ–ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

1. **æ¨¡å‹å®šä¹‰ä¸ç®¡ç†**ï¼šæä¾›å¤šç§YOLOæ¨¡å‹çš„å®ç°ï¼Œæ”¯æŒä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼ˆå¦‚æ£€æµ‹ã€åˆ†ç±»ã€åˆ†å‰²ç­‰ï¼‰ã€‚
2. **æ•°æ®å¤„ç†**ï¼šå®ç°äº†é«˜æ•ˆçš„æ•°æ®åŠ è½½å’Œé¢„å¤„ç†æœºåˆ¶ï¼Œæ”¯æŒå¤šç§æ•°æ®æºå’Œå¢å¼ºæŠ€æœ¯ã€‚
3. **è®­ç»ƒä¸éªŒè¯**ï¼šæä¾›è®­ç»ƒè¿‡ç¨‹çš„ç®¡ç†ï¼ŒåŒ…æ‹¬æŸå¤±è®¡ç®—ã€æ¨¡å‹ä¿å­˜ã€æ—©åœæœºåˆ¶ç­‰ã€‚
4. **æ¨ç†ä¸è¯„ä¼°**ï¼šæ”¯æŒæ¨¡å‹çš„æ¨ç†å’Œæ€§èƒ½è¯„ä¼°ï¼Œèƒ½å¤Ÿè¾“å‡ºé¢„æµ‹ç»“æœå’Œç›¸å…³æŒ‡æ ‡ã€‚
5. **å·¥å…·ä¸å®ç”¨å‡½æ•°**ï¼šæä¾›å¤šç§å®ç”¨å·¥å…·å‡½æ•°ï¼Œæ”¯æŒè®¾å¤‡é€‰æ‹©ã€å‚æ•°åˆå§‹åŒ–ã€å›¾åƒå¤„ç†ç­‰ã€‚

ä»¥ä¸‹æ˜¯é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„åŠŸèƒ½æ•´ç†è¡¨æ ¼ï¼š

| æ–‡ä»¶è·¯å¾„                                                                                          | åŠŸèƒ½æè¿°                                                                                      |
|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| `code/ultralytics/models/fastsam/__init__.py`                                                    | åˆå§‹åŒ–FastSAMæ¨¡å—ï¼Œå¯¼å…¥æ ¸å¿ƒç±»ä»¥ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚                                               |
| `code/ultralytics/utils/torch_utils.py`                                                          | æä¾›ä¸PyTorchç›¸å…³çš„å·¥å…·å‡½æ•°ï¼Œå¦‚è®¾å¤‡é€‰æ‹©ã€æ¨¡å‹ä¿¡æ¯ã€æ•°æ®åŠ è½½ã€æ—©åœæœºåˆ¶ç­‰ã€‚                     |
| `code/ultralytics/data/build.py`                                                                  | æ„å»ºYOLOæ•°æ®é›†å’Œæ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒå¤šç§è¾“å…¥æºå’Œæ•°æ®å¢å¼ºã€‚                                         |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/engine/trainer.py`          | å®ç°YOLOæ¨¡å‹çš„è®­ç»ƒæ¡†æ¶ï¼Œç®¡ç†è®­ç»ƒè¿‡ç¨‹ã€æŸå¤±è®°å½•ã€éªŒè¯å’Œæ¨¡å‹ä¿å­˜ç­‰åŠŸèƒ½ã€‚                         |
| `train.py`                                                                                        | å…·ä½“å®ç°YOLOæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œå¤„ç†æ•°æ®é›†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰ã€‚                     |
| `code/ultralytics/models/yolo/model.py`                                                          | å®šä¹‰YOLOæ¨¡å‹ç±»ï¼Œç®¡ç†ä¸åŒä»»åŠ¡ç±»å‹çš„æ¨¡å‹å’Œç›¸å…³å·¥å…·ã€‚                                             |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/models/sam/modules/decoders.py` | å®ç°SAMï¼ˆSegment Anything Modelï¼‰æ¨¡å—çš„è§£ç å™¨ï¼Œå¤„ç†æ¨¡å‹è¾“å‡ºã€‚                                 |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰/ultralytics/nn/backbone/VanillaNet.py` | å®šä¹‰VanillaNetéª¨å¹²ç½‘ç»œï¼Œç”¨äºç‰¹å¾æå–ã€‚                                                        |
| `code/ultralytics/models/sam/amg.py`                                                             | å®ç°SAMæ¨¡å—çš„è‡ªé€‚åº”å¤šå°ºåº¦ç”Ÿæˆï¼ˆAMGï¼‰åŠŸèƒ½ï¼Œå¤„ç†å¤šå°ºåº¦è¾“å…¥ã€‚                                     |
| `code/ultralytics/trackers/byte_tracker.py`                                                     | å®ç°ByteTrackerï¼Œæ”¯æŒç›®æ ‡è·Ÿè¸ªåŠŸèƒ½ã€‚                                                            |
| `code/ultralytics/utils/callbacks/mlflow.py`                                                    | æä¾›ä¸MLflowé›†æˆçš„å›è°ƒå‡½æ•°ï¼Œç”¨äºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„ç›‘æ§å’Œè®°å½•ã€‚                                   |
| `ui.py`                                                                                           | å®ç°ç”¨æˆ·ç•Œé¢ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½ç”¨äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹æˆ–ç»“æœå±•ç¤ºã€‚                                       |
| `code/ultralytics/utils/loss.py`                                                                 | å®šä¹‰æŸå¤±å‡½æ•°çš„å®ç°ï¼Œè®¡ç®—æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±å€¼ã€‚                                              |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†é¡¹ç›®çš„æ¨¡å—åŒ–è®¾è®¡å’Œå„éƒ¨åˆ†ä¹‹é—´çš„åä½œå…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/Zpubkphp](https://mbd.pub/o/bread/Zpubkphp)